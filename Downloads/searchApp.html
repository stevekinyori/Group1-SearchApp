<-- This is group 1 search -->
<html>
<head>
    <title></title>
    <script type = "text/javascript" src="js/jquery.js"></script>
</head>
<style>
    #results{
        width:220px;
        padding:10px;
        border:5px solid gray;
        margin:auto;
        float:left;
    }
    #section{
        margin-left: 300px;
        border: solid black 2px;
        margin-top: -100px;
        width: 400px;
    }
    #charts{
    }
</style>
<script type = "text/javascript">
<!-- the following funtion is used when fetching the charts.
the logic used is to loop through the chart idicator ids and match
them to the id of the selected indicator then the chart is loaded.-->
    function dispCharts(ind_id)
    {
        chats = [];
        $("#charts").html("");
        $.get('../../../api/charts.json',function(charty){
            $(charty.charts).each(function (index,data){
                $.get(data.href+".json",function (schart){
                    $(schart).each(function (i,d){
                        $(d.indicators).each(function (i, cdata){
                            if (ind_id == cdata.id)
                            {
<!-- this is a condition that checks if the chart's indicator id matches the id of the selected idicator.-->
<!--if they are similar ten we create a new imaje object and assign its source to the chart's location.-->
                                chats.push(schart.id);
                                image1 = new Image();
                                image1.src = '../../../api/charts/'+schart.id+'/data';
                                image1.width = 300;
                                image1.height = 300;
                                $("#charts").append(image1);
                            }
                        });
                    });
                }).done(function(){
                            console.log(chats.length);

                        });
            });
        });
        $("#charts").append("<hr/>");
    }
<!-- the following funtion is used when fetching the maps.
the logic used is to loop through the maps idicator ids, if they match
the id of the selected indicator then the map is loaded.-->
    function dispMaps(ind_id)
    {
        chats = [];
        $("#maps").html("");
        $.get('../../../api/mapViews.json',function(mapy){
            $(mapy.mapViews).each(function (index,data){
                $.get(data.href+".json",function (smapy){
                    $(smapy).each(function (i,d){
                        $(d.indicator).each(function (i, cdata){
                            if (ind_id == cdata.id)
                            {

                                chats.push(smapy.id);
                                image1 = new Image();
                                image1.src = '../../../api/mapViews/'+smapy.id+'/data';
                                image1.width = 300;
                                image1.height = 300;
                                $("#maps").append(image1);
                            }
                        });
                    });
                }).done(function(){
                            console.log(chats.length);

                        });
            });
        });
        $("#maps").append("<hr/>");
    }
<!-- the following funtion is used when fetching the reports.
the logic used is to loop through the reports idicator ids, if they match
the id of the selected indicator then the report is loaded.-->
    function dispReports(ind_id)
    {
        chats = [];
        $("#reports").html("");
        $.get('../../../api/reportTables.json',function(repy){
            $(repy.reportTables).each(function (index,data){
                $.get(data.href+".json",function (repy){
                    $(repy).each(function (i,d){
                        $(d.indicators).each(function (i, cdata){
                            if (ind_id == cdata.id)
                            {

                                chats.push(repy.id);
                                rframe = document.createElement("IFRAME");
                                rframe.style.width = 500 +"px";
                                rframe.style.height = 250 +"px";
                                rframe.setAttribute("src",'../../../api/reportTables/'+repy.id+'/data'+'.html');
                                /* image1.src = '../api/mapViews/'+repy.id+'/data'+html;
                                 image1.width = 300;
                                 image1.height = 300;*/
                                $("#reports").append(rframe);
                            }
                        });
                    });
                }).done(function(){
                            console.log(chats.length);

                        });
            });
        });
        $("#reports").append("<hr/>");
    }


    $(document).ready(function(){
<!-- when the document is done loading, this function is used
to minimize the chances of the scrips running before the whole document has loaded. -->
    
        $("#search").keyup(function(){  <!-- this is used to run a script or function after the release of a key -->
            $("#charts").html("");
            $("#results").html("");
            $("#maps").html("");
            $.get('../../../api/indicatorGroups/query/'+$(this).val()+'.json', function(json){
<!-- this function is used to loop through the indicator groups and find the group that matches to the entered letters-->

                $(json.indicatorGroups).each(function(i, data){
                    var anchor = $("<a></a>").attr("href",data.href).append(data.name);
                    $("#results").append(anchor).append("<br/>");
                    anchor.bind("click",function(e){
<!-- this is a function that is used to search fro the indicators linked to a selected indicator group -->
                        $("#section").html("");
                        e.preventDefault();
                        $.get($(this).attr("href")+".json", function(json){
                            $(json.indicators).each(function(i, d){
                                var indics = $("<a></a>").attr("href","#").append(d.name);
                                $("#section").append(indics).append("<br/>");
                                indics.bind("click",function (evt){
                                    evt.preventDefault();
                                    dispCharts(d.id);
                                    dispMaps(d.id);
                                    dispReports(d.id);
                                });
                            });
                        });
                    });

                });
            });
        });
    });
</script>

<div>
    <label for = "search">Search Indicator Group</label>
    <input type = "text" id = "search"/>
    <div id = "results">
<!-- display of the indicator groups -->
    </div> 
    <div id = "section">
<!-- display of the indicators-->
    </div>
    <div id = "charts">
<!-- display of the charts -->
    </div>
    <div id = "maps">
<!-- display of the maps -->
    </div>
    <div id = "reports">
<!-- display of the reports -->
    </div>
</div>
</html>
